<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Поиск квадрата - Игра</title>
    <link rel="stylesheet" href="../../../styles.css">
    <link rel="stylesheet" href="square_game.css">
    <style>
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
            background: white;
            padding: 8px 15px;
            border-radius: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .username {
            font-weight: bold;
            color: #7c3aed;
        }

        .change-name-btn {
            background: #e9d5ff;
            color: #7c3aed;
            border: none;
            padding: 4px 8px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }
    </style>
</head>

<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo-title">
                    <h1>Игра "Распознание квадратов"</h1>
                </div>
                <nav class="main-nav">
                    <a href="../main_page/index.html" class="nav-link">Меню игры</a>
                    <a href="../rating.html" class="nav-link">Рейтинг игроков</a>
                </nav>
                <div class="user-info" id="user-info"></div>
            </div>
        </div>
    </header>

    <main class="container">
        <div class="game-container">
            <div class="game-header">
                <div class="header-controls">
                    <button class="back-btn" onclick="return showExitModal()">
                        ← Назад
                    </button>
                    <button class="restart-btn" onclick="return showRestartModal()">
                        ↻ Перезапуск
                    </button>
                </div>

                <div class="game-stats">
                    <div class="timer">
                        <span>Время:</span>
                        <span id="timer">10:00</span>
                    </div>
                    <div class="attempts">
                        <span>Ошибок (всего):</span>
                        <span id="wrong-attempts">0</span>
                    </div>
                    <div class="rotations">
                        <span>Повороты:</span>
                        <span id="rotation-count">0</span>
                    </div>
                    <div class="wrong-current">
                        <span>Ошибок (уровень):</span>
                        <span id="wrong-attempts-current">0</span>
                    </div>
                    <div class="score">
                        <span>Баллы:</span>
                        <span id="current-score">1200</span>
                    </div>
                </div>
            </div>

            <div class="game-area">
                <div class="search-area">
                    <h2>Найдите соответствующий квадрат:</h2>
                    <div class="error-message" id="error-message"></div>
                    <div class="squares-grid" id="squares-container"></div>
                </div>

                <div class="sample-area">
                    <h2>Образец</h2>
                    <div class="sample-square" id="sample-square"></div>
                    <button class="rotate-btn" onclick="rotateSample()">
                        Повернуть на 90°
                    </button>
                    <div class="level-info" id="level-info"></div>
                </div>
            </div>
        </div>
    </main>

    <div class="modal-overlay" id="modal-overlay"></div>

    <div class="modal" id="win-modal">
        <div class="modal-header">
            <h2>Ура! Вы прошли игру!</h2>
            <button class="close-modal" onclick="hideModal()">×</button>
        </div>
        <div class="modal-content">
            <div class="stats-grid">
                <div class="stat-item">
                    <strong id="win-username">Игрок</strong>
                    <span>Игрок</span>
                </div>
                <div class="stat-item">
                    <strong id="win-time">00:00</strong>
                    <span>Общее время</span>
                </div>
                <div class="stat-item">
                    <strong id="win-attempts">0</strong>
                    <span>Ошибок</span>
                </div>
                <div class="stat-item">
                    <strong id="win-rotations">0</strong>
                    <span>Повороты</span>
                </div>
                <div class="stat-item" style="grid-column: span 2;">
                    <strong id="win-score">1200</strong>
                    <span>Итоговый балл</span>
                </div>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn primary" onclick="window.location.href='../main_page/index.html'">
                    В меню
                </button>
                <button class="modal-btn" onclick="window.location.href='../rating.html'">
                    Рейтинг игроков
                </button>
            </div>
        </div>
    </div>

    <div class="modal" id="lose-modal">
        <div class="modal-header">
            <h2>Игра окончена</h2>
            <button class="close-modal" onclick="hideModal()">×</button>
        </div>
        <div class="modal-content">
            <p id="lose-reason">Причина проигрыша</p>

            <div class="stats">
                <p><strong>Время:</strong> <span id="lose-time">00:00</span></p>
                <p><strong>Ошибок:</strong> <span id="lose-attempts">0</span></p>
                <p><strong>Повороты:</strong> <span id="lose-rotations">0</span></p>
                <p><strong>Баллы:</strong> <span id="lose-score">0</span></p>
            </div>

            <div class="correct-hint">
                <div style="display: inline-block; position: relative; margin: 10px;">
                    <div class="correct-number">
                        ✓ 3
                    </div>
                </div>
                <p><small>Правильный ответ отмечен зелёной обводкой и номером сверху справа</small></p>
            </div>

            <div class="modal-buttons">
                <button class="modal-btn primary" onclick="restartGame()">Начать заново</button>
                <button class="modal-btn" onclick="window.location.href='../main_page/index.html'">
                    В меню
                </button>
            </div>
        </div>
    </div>

    <div class="modal" id="confirm-exit-modal">
        <div class="modal-header">
            <h2>Подтверждение выхода</h2>
            <button class="close-modal" onclick="hideModal()">×</button>
        </div>
        <div class="modal-content">
            <p>Вы уверены, что хотите покинуть страницу? Ваш прогресс будет утерян!</p>
            <div class="confirm-buttons">
                <button class="confirm-btn danger" onclick="goBack()">Уйти</button>
                <button class="confirm-btn secondary" onclick="hideModal()">Остаться</button>
            </div>
        </div>
    </div>

    <div class="modal" id="confirm-restart-modal">
        <div class="modal-header">
            <h2>Подтверждение перезапуска</h2>
            <button class="close-modal" onclick="hideModal()">×</button>
        </div>
        <div class="modal-content">
            <p>Вы уверены, что хотите заново начать игру? Ваш прогресс будет утерян!</p>
            <div class="confirm-buttons">
                <button class="confirm-btn danger" onclick="restartGame()">Перезапустить</button>
                <button class="confirm-btn secondary" onclick="hideModal()">Отменить</button>
            </div>
        </div>
    </div>

    <script src="square_game.js"></script>
</body>

</html>